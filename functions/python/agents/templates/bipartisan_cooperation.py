from dataclasses import dataclass
from typing import List, Dict, Optional
import re

@dataclass
class ToneLevel:
    id: str
    name: str
    when: str
    tone: str
    template: str
    caution: str = ""
    connection: str = ""
    required: str = ""
    structure: str = ""

@dataclass
class GenerationTemplate:
    id: str
    name: str
    structure: str
    example: str

TONE_LEVELS = {
    "LEVEL_1_OBJECTIVE": ToneLevel(
        id='objective_acknowledgment',
        name='1ë‹¨ê³„: ê°ê´€ì  ì¸ì • (ê°€ì¥ ì•ˆì „)',
        when='íŒ©íŠ¸ë§Œ ì „ë‹¬í•  ë•Œ',
        tone='ê°ì • ë°°ì œ, ì ˆì œë¨',
        template='â—‹â—‹ ì˜ì›ì´ ì œì‹œí•œ [êµ¬ì²´ì  ë‚´ìš©]ì˜ ë¬¸ì œ ì§€ì ì€ ê·¼ê±°ê°€ ìˆë‹¤.',
        caution='ê°íƒ„Â·ì¹­ì°¬ í†¤ ìµœì†Œí™”'
    ),
    "LEVEL_2_SPECIFIC": ToneLevel(
        id='specific_acknowledgment',
        name='2ë‹¨ê³„: êµ¬ì²´ì  ì¸ì • (ê¶Œì¥)',
        when='íŠ¹ì • í–‰ë™Â·ì„±ê³¼ë¥¼ ê¸ì •í•  ë•Œ',
        tone='êµ¬ì²´ì  ê·¼ê±° + ë²”ìœ„ í•œì •',
        template='[êµ¬ì²´ì  í–‰ë™]ì„ ë³´ì—¬ì¤€ â—‹â—‹ ì˜ì›ì˜ ë…¸ë ¥ë§Œí¼ì€ ì§„ì‹¬ìœ¼ë¡œ ì¸ì •í•  ìˆ˜ ìˆë‹¤.',
        connection='+ ì´ëŸ° ë¶€ë¶„ì€ ì—¬ì•¼ê°€ í•¨ê»˜ ë°°ì›Œì•¼ í•œë‹¤'
    ),
    "LEVEL_3_POLITE": ToneLevel(
        id='polite_with_difference',
        name='3ë‹¨ê³„: ì •ì¤‘í•œ ì¸ì • + ì°¨ì´ ëª…ì‹œ',
        when='ì˜ê²¬ì€ ë‹¤ë¥´ì§€ë§Œ ì¸ë¬¼Â·ê³¼ì •ì€ ì¸ì •í•  ë•Œ',
        structure='ì°¨ì´ ë¨¼ì € â†’ êµ¬ì²´ì  ì¸ì • â†’ ì¸ê²© ì¡´ì¤‘',
        tone='ì°¨ì´ ë¨¼ì € â†’ êµ¬ì²´ì  ì¸ì • â†’ ì¸ê²© ì¡´ì¤‘', # Using structure as tone for consistency if needed
        template='ì •ì±… ë°©í–¥ì€ ë‹¤ë¥´ì§€ë§Œ, â—‹â—‹ ì˜ì›ì˜ [êµ¬ì²´ì  í–‰ë™]ì€ ë°”ëŒì§í•˜ë‹¤ê³  ë³¸ë‹¤.'
    ),
    "LEVEL_4_LIMITED_COOPERATION": ToneLevel(
        id='limited_cooperation',
        name='4ë‹¨ê³„: í•œì •ì  í˜‘ë ¥ ì œì•ˆ',
        when='ê³µë™ ì´ìµì´ ìˆì„ ë•Œë§Œ',
        required='í˜‘ë ¥ ë²”ìœ„ë¥¼ ëª…í™•íˆ í•œì •',
        tone='í˜‘ë ¥ ë²”ìœ„ë¥¼ ëª…í™•íˆ í•œì •', # Using required as tone
        template='[íŠ¹ì • ì‚¬ì•ˆ]ë§Œí¼ì€ ì—¬ì•¼ê°€ í•¨ê»˜ ë…¼ì˜í•  ê°€ì¹˜ê°€ ìˆë‹¤.',
        caution='"ì •ì±… ê¸°ì¡°ì˜ ì°¨ì´ëŠ” ë‚¨ì•„ ìˆë‹¤" ëª…ì‹œ í•„ìˆ˜'
    )
}

GENERATION_TEMPLATES = {
    "POLICY_ACHIEVEMENT": GenerationTemplate(
        id='policy_achievement',
        name='ì •ì±… ì„±ê³¼ ì¸ì •',
        structure="""[ì°¨ì´ ì¸ì •] ì •ì±… ë°©í–¥ì€ ë‹¤ë¥¼ ìˆ˜ ìˆì§€ë§Œ,
[êµ¬ì²´ì  ê·¼ê±°] â—‹â—‹ ì˜ì›ì´ [êµ¬ì²´ì  í–‰ë™/ì„±ê³¼]
[ì¡´ì¤‘ í‘œí˜„] ì ì€ ë†’ì´ í‰ê°€í•œë‹¤.
[ì´ˆë‹¹ ì—°ê²°] ì´ëŸ° ë¶€ë¶„ì€ ì—¬ì•¼ê°€ í•¨ê»˜ ë°°ì›Œì•¼ í•œë‹¤.""",
        example='ì •ì±… ë°©í–¥ì€ ë‹¤ë¥¼ ìˆ˜ ìˆì§€ë§Œ, â—‹â—‹ ì˜ì›ì´ ì¼ ë…„ê°„ ì¤‘ì†Œìƒì¸ë“¤ì„ ì§ì ‘ ë°©ë¬¸í•´ í˜„í™©ì„ ì²­ì·¨í•˜ëŠ” ëª¨ìŠµì€ ì§„ì‹¬ìœ¼ë¡œ ì¸ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ° í˜„ì¥ ì¤‘ì‹¬ì˜ ì˜ì •í™œë™ì€ ì—¬ì•¼ê°€ í•¨ê»˜ ë°°ì›Œì•¼ í•œë‹¤ê³  ë´…ë‹ˆë‹¤.'
    ),
    "CRISIS_RESPONSE": GenerationTemplate(
        id='crisis_response',
        name='ìœ„ê¸° ëŒ€ì‘/ì¸ë¬¼ ì¸ì •',
        structure="""[ìƒí™©] ì´ë²ˆ [ì‚¬ê±´]ì—ì„œ
[ì¸ë¬¼ í–‰ë™] â—‹â—‹ ì‹œì¥ì˜ [êµ¬ì²´ì  í–‰ë™]ì€
[ì ˆì œëœ ì¸ì •] ì‹œë¯¼ ì•ˆì „ì„ ìš°ì„ í•œ ì„ íƒì´ë‹¤.
[í˜‘ë ¥ ì œì•ˆ] ì´ëŸ° ë¶€ë¶„ì—ì„œëŠ” ì •íŒŒë¥¼ ë„˜ì–´ í•¨ê»˜ ì›€ì§ì¼ ê°€ì¹˜ê°€ ìˆë‹¤.""",
        example='ì´ë²ˆ ì¬ë‚œ ëŒ€ì‘ì—ì„œ â—‹â—‹ ì‹œì¥ì´ ì‹ ì†í•˜ê²Œ í˜„ì¥ì— ë‚˜ê°€ ì—¬ì•¼ êµ¬ë¶„ ì—†ì´ í”¼í•´ìë¥¼ ì±™ê¸´ ëª¨ìŠµì€ ì‹œë¯¼ ì•ˆì „ì„ ìš°ì„ í•œ ì„ íƒì´ë¼ê³  ë´…ë‹ˆë‹¤. ì´ëŸ° ìˆœê°„ì—ëŠ” ì •íŒŒë¥¼ ë„˜ì–´ í•¨ê»˜ ì›€ì§ì—¬ì•¼ í•œë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤.'
    ),
    "LIMITED_COOPERATION": GenerationTemplate(
        id='limited_cooperation',
        name='í•œì •ì  í˜‘ë ¥ ì œì•ˆ',
        structure="""[ì…ì¥ ì°¨ì´] â—‹â—‹ ì˜ì›ê³¼ëŠ” [ìŸì ]ì—ì„œ ì…ì¥ì´ ë‹¤ë¥´ì§€ë§Œ,
[ê³µë™ ì´ìµ] [êµ­ìµ/ë¯¼ìƒ/ì•ˆë³´]ì—ì„œëŠ”
[í˜‘ë ¥ ë²”ìœ„] ì´ ë¶€ë¶„ë§Œí¼ì€ í•¨ê»˜ ë…¼ì˜í•  ê°€ì¹˜ê°€ ìˆë‹¤.
[í•œê³„ ëª…ì‹œ] ì •ì±… ê¸°ì¡°ì˜ ì°¨ì´ëŠ” ë‚¨ì•„ ìˆë‹¤.""",
        example='ì¬ì • ì •ì±…ì—ì„œëŠ” ì…ì¥ì´ ë‹¤ë¥´ì§€ë§Œ, êµ­ê°€ ì±„ë¬´ íˆ¬ëª…ì„± ê°•í™” ì°¨ì›ì—ì„œëŠ” â—‹â—‹ ì˜ì›ì˜ ì œì•ˆì„ í•¨ê»˜ ê²€í† í•  ê°€ì¹˜ê°€ ìˆë‹¤ê³  ë´…ë‹ˆë‹¤. ì •ì±… ì‹œí–‰ ë°©ì‹ì—ì„œëŠ” ì—¬ì „íˆ ì…ì¥ ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤.'
    ),
    "PRINCIPLED_STANCE": GenerationTemplate(
        id='principled_stance',
        name='ì†Œì‹  ë°œì–¸ ì¸ì •',
        structure="""[ìƒí™©] ì´ë²ˆ [ì‚¬ì•ˆ]ì—ì„œ
[ì¸ë¬¼ í–‰ë™] â—‹â—‹ ì˜ì›ì´ [ì†Œì‹  ë°œì–¸/í–‰ë™]í•œ ì ì€
[ë²”ìœ„ í•œì •] ì´ ë¶€ë¶„ë§Œí¼ì€ ë†’ì´ í‰ê°€í•œë‹¤.
[ìê¸° PR] ì € ë˜í•œ ì´ëŸ¬í•œ ì›ì¹™ ìœ„ì—ì„œ [í™”ìì˜ ë¹„ì „/ì •ì±…]ì„ ì¶”ì§„í•œë‹¤.""",
        example='ì´ë²ˆ í—Œì • ìœ„ê¸° ìƒí™©ì—ì„œ ì¡°ê²½íƒœ ì˜ì›ì´ ë‹¹ì„ ë„˜ì–´ ì›ì¹™ì„ ì§€í‚¨ ì ì€ ë†’ì´ í‰ê°€í•©ë‹ˆë‹¤. ì € ë˜í•œ ì´ëŸ¬í•œ ì›ì¹™ ìœ„ì—ì„œ ë¶€ì‚°ì˜ ë¯¸ë˜ë¥¼ ìœ„í•œ ì •ì±…ì„ ì¶”ì§„í•˜ê² ìŠµë‹ˆë‹¤.'
    )
}

KOREAN_POLITICAL_CONTEXT = """
**í•œêµ­ ì •ì¹˜ ë¬¸í™”ì˜ íŠ¹ìˆ˜ì„±** (LLM ìƒì„± ì‹œ ë°˜ë“œì‹œ ë°˜ì˜):

1. **íŒ¬ë¤ ì •ì¹˜ì˜ ê°•ë ¥í•¨**: ê³¼í•œ ì¸ë¬¼ ë„ìš°ê¸°ëŠ” 'ì •ì¹˜ì  ì‹¤ìˆ˜'ë¡œ ì½í˜
2. **ê°•ì„± ì§€ì§€ì¸µì˜ ë¯¼ê°ë„**: ìë‹¹ í„í•˜ëŠ” 'ë°°ì‹ 'ìœ¼ë¡œ í•´ì„ë  ìˆ˜ ìˆìŒ
3. **ì´ˆë‹¹ì  í˜‘ë ¥ì˜ ì‹¤ì§ˆì„±**: ì¶”ìƒì  "í•¨ê»˜í•˜ì"ë³´ë‹¤ êµ¬ì²´ì  ì‚¬ì•ˆ ì œì‹œê°€ ì¤‘ìš”
4. **í˜„ì¥ ì¤‘ì‹¬ í‰ê°€**: "ë¬´ì—‡ì„ í–ˆëŠ”ê°€"ê°€ "ì–¼ë§ˆë‚˜ í›Œë¥­í•œê°€"ë³´ë‹¤ ë” ì„¤ë“ë ¥ ìˆìŒ
5. **ìƒìœ„ ì •ì²´ì„± í™œìš©**: "ì§€ì—­ì—ëŠ” ì—¬ì•¼ê°€ ì—†ë‹¤", "êµ­ê°€ ì´ìµ ìš°ì„ " ë“± í™œìš© ê°€ëŠ¥
"""

def build_bipartisan_cooperation_prompt(options: dict = None) -> str:
    options = options or {}
    
    defaults = {
        'topic': '',
        'targetCount': 1800,
        'authorBio': 'ì´ì¬ì„±',
        'instructions': '',
        'newsContext': '',
        'templateId': 'principled_stance',
        'toneLevel': 'LEVEL_2_SPECIFIC',
        'personalizedHints': ''
    }
    
    # Merge defaults
    merged_options = {**defaults, **options}
    
    topic = merged_options['topic']
    target_count = merged_options['targetCount']
    author_bio = merged_options['authorBio']
    instructions = merged_options['instructions']
    news_context = merged_options['newsContext']
    template_id = merged_options['templateId']
    tone_level = merged_options['toneLevel']
    personalized_hints = merged_options['personalizedHints']

    # Validation
    valid_target_count = target_count if 500 <= target_count <= 5000 else 1800

    template_key = template_id.upper()
    template = GENERATION_TEMPLATES.get(template_key, GENERATION_TEMPLATES['PRINCIPLED_STANCE'])

    tone_key = tone_level.upper()
    tone = TONE_LEVELS.get(tone_key, TONE_LEVELS['LEVEL_2_SPECIFIC'])

    comp_praise_chars = round(valid_target_count * 0.2)
    self_pr_chars = round(valid_target_count * 0.5)
    situation_chars = round(valid_target_count * 0.15)
    conclusion_chars = round(valid_target_count * 0.2)

    prompt = f"""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸ¤ [ì´ˆë‹¹ì  í˜‘ë ¥] íƒ€ ì •ë‹¹ ì¸ì‚¬ ì œí•œì  ì¸ì • í…œí”Œë¦¿              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”´ğŸ”´ğŸ”´ **[ìµœìš°ì„  ê·œì¹™] ê²½ìŸì ì¹­ì°¬ ë¹„ì¤‘ 10-20% ì œí•œ** ğŸ”´ğŸ”´ğŸ”´
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
- ê²½ìŸì(ì¡°ê²½íƒœ ë“±) ì–¸ê¸‰ì€ **ìµœëŒ€ {comp_praise_chars}ì** (20%)
- **ìê¸°PRì´ 50% ({self_pr_chars}ì) ì´ìƒ**ì´ì–´ì•¼ í•¨
- ì´ˆê³¼ ì‹œ ì›ê³  íê¸°ë¨
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

{KOREAN_POLITICAL_CONTEXT}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸš¨ **[ì ˆëŒ€ ê¸ˆì§€] ê¸ˆì§€ í‘œí˜„ â†’ ëŒ€ì²´ í‘œí˜„** (ìœ„ë°˜ ì‹œ ì›ê³  íê¸°)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

| âŒ ê¸ˆì§€ í‘œí˜„ | âœ… ëŒ€ì²´ í‘œí˜„ |
| :--- | :--- |
| "ì „ì ìœ¼ë¡œ ë™ì˜í•œë‹¤" | "ì´ ë¶€ë¶„ë§Œí¼ì€ ì¸ì •í•  ìˆ˜ ìˆë‹¤" |
| "ì „ì ìœ¼ë¡œ ê³µê°í•œë‹¤" | "ì´ë²ˆ ì‚¬ì•ˆì— í•œí•´ ê³µê°í•œë‹¤" |
| "ë³¸ë°›ì•„ì•¼ í•œë‹¤" | "ì´ ì ì€ ì°¸ê³ í•  ìˆ˜ ìˆë‹¤" |
| "ê¹Šì´ ê³µê°í•œë‹¤" | "ì´ë²ˆ ë°œì–¸ì€ ì£¼ëª©í•  ë§Œí•˜ë‹¤" |
| "ê¹Šì€ ìš¸ë¦¼" | "ì£¼ëª©í•  ë§Œí•œ ë°œì–¸" |
| "ìš©ê¸°ì— ë°•ìˆ˜" | "ì›ì¹™ì„ ì§€í‚¨ ì ì€ ì¸ì •" |
| "ê·€ê°ì´ ë©ë‹ˆë‹¤" | "ì°¸ê³ í•  ë§Œí•©ë‹ˆë‹¤" |
| "ë™ë ¥ì´ ë  ê²ƒ" | "ê¸ì •ì  ê³„ê¸°" |
| "ë‚˜ì¹¨ë°˜ì´ ë  ê²ƒ" | "ë°©í–¥ ì œì‹œ" |
| "ì¶©ê²©ì ì¸ ì†Œì‹" | "ì£¼ëª©í•  ë§Œí•œ ì†Œì‹" |
| "ë§ˆìŒì´ ë¬´ê²ë‹¤" | "ì—„ì¤‘í•˜ê²Œ ë°›ì•„ë“¤ì¸ë‹¤" |
| "ì•ˆíƒ€ê¹ë‹¤" | "ìœ ê°ìŠ¤ëŸ½ë‹¤" |

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“¢ [ìœ¤ì„ì—´ ì‚¬íƒœ ê´€ë ¨ ë…¼ë¦¬ êµ¬ì¡°(Logic) ê°€ì´ë“œ - CRITICAL]
1. **[ì¸ê³¼ê´€ê³„ ì ˆëŒ€ ì¤€ìˆ˜]**:
   - âŒ "ì‚¬í˜• êµ¬í˜• ì†Œì‹ì´ ì¶©ê²©ì ì´ë‹¤/ë¯¼ì£¼ì£¼ì˜ ìœ„ê¸°ë‹¤" (ì ˆëŒ€ ê¸ˆì§€ - êµ¬í˜•ì„ ë¹„íŒí•˜ëŠ” ê²ƒì²˜ëŸ¼ ì½í˜)
   - âœ… "12.3 ë‚´ë€(ë²”ì£„)ì´ ë¯¼ì£¼ì£¼ì˜ ìœ„ê¸°ì˜€ìœ¼ë©°, **ì‚¬í˜• êµ¬í˜•(ì‹¬íŒ)ì€ ì •ì˜ì˜ ì‹¤í˜„**ì´ë‹¤." (êµ¬í˜•ì„ í™˜ì˜í•´ì•¼ í•¨)
   
2. **[ê°ì • ë°°ì œ]**: "ì•ˆíƒ€ê¹ë‹¤", "ë§ˆìŒì´ ë¬´ê²ë‹¤", "ì¶©ê²©" ë“±ì˜ í‘œí˜„ì€ **í”¼í•´ì ì½”ìŠ¤í”„ë ˆ**ë¡œ ì˜¤í•´ë°›ì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì ˆëŒ€ ì“°ì§€ ë§ˆì‹­ì‹œì˜¤. ì˜¤ì§ **"ì‚¬í•„ê·€ì •", "ì—„ì •í•œ ë²•ì˜ ì‹¬íŒ", "ë‹¹ì—°í•œ ê·€ê²°"**ë¡œë§Œ í‘œí˜„í•˜ì‹­ì‹œì˜¤.

3. **[ìš©ì–´ í†µì¼]**: "ì „ ëŒ€í†µë ¹" í˜¸ì¹­ì€ ìœ ì§€í•˜ë˜, ì˜ˆìš°ë¥¼ ê°–ì¶”ê±°ë‚˜ ì•ˆíƒ€ê¹Œì›Œí•˜ëŠ” ìˆ˜ì‹ì–´ëŠ” ëºë‹ˆë‹¤.
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Œ í•µì‹¬ ì›ì¹™ 3ê°€ì§€
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. **ì°¨ì´ ë¨¼ì € ëª…ì‹œ, ì¸ë¬¼ì€ ë¶„ë¦¬**: ì •ì±… ë°©í–¥ì€ ë‹¤ë¥´ì§€ë§Œ ì¸ê²©Â·í–‰ë™Â·ë…¸ë ¥ì€ ì¡´ì¤‘
2. **êµ¬ì²´ì„± í•„ìˆ˜, ì¶”ìƒ ê·¹ì°¬ ê¸ˆì§€**: "ì •ë§ í›Œë¥­í•˜ë‹¤"ë³´ë‹¤ "â—‹â—‹ë¥¼ ì§€ì†ì ìœ¼ë¡œ ì œê¸°í•´ ì˜¨ ì "
3. **ì´ˆë‹¹ì  í˜‘ë ¥ìœ¼ë¡œ ì—°ê²°**: ì¹­ì°¬ í›„ ë°”ë¡œ ê³µë™ëª©í‘œ(ë¯¼ìƒ, ì•ˆë³´, êµ­ìµ)ë¡œ ì´ì–´ê°€ê¸°

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ¯ í˜„ì¬ í†¤ ê°•ë„: {tone.name}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

**ì‚¬ìš© ì‹œì **: {tone.when}
**í†¤ íŠ¹ì„±**: {tone.tone}
**í…œí”Œë¦¿**: {tone.template}
{f"**ì£¼ì˜**: {tone.caution}" if tone.caution else ""}
{f"**ì—°ê²°**: {tone.connection}" if tone.connection else ""}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸš¨ [CRITICAL] 5ë‹¨ê³„ ê¸ˆì§€ í‘œí˜„ - ìœ„ë°˜ ì‹œ ì›ê³  íê¸°
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

| ìœ í˜• | ê¸ˆì§€ í‘œí˜„ | ì´ìœ  |
| :--- | :--- | :--- |
| ìì§„ì˜ í„í•˜ | "ìš°ë¦¬ë³´ë‹¤ ë‚«ë‹¤", "ìš°ë¦¬ëŠ” ì €ë ‡ê²Œ ëª»í•œë‹¤" | ì§€ì§€ì¸µ ë°°ì‹  ì‹ í˜¸ |
| ì „ë©´ì  ë™ì˜ | "ì „ì ìœ¼ë¡œ ë™ì˜/ê³µê°", "ì •ì±…ì´ 100% ë§ë‹¤" | ì…ì¥ í˜¼ì„  |
| ê³¼ì¥ ê·¹ì°¬ | "ì •ì¹˜ì¸ ì¤‘ ìµœê³ ", "ìœ ì¼í•˜ê²Œ ë¯¿ì„ ìˆ˜ ìˆë‹¤" | íŒ¬ë¤ ìê·¹ |
| ì¶”ìƒ ê·¹ì°¬ | "ì •ì‹ ì„ ì´ì–´ë°›ì•„", "ë³¸ë°›ì•„", "ê·€ê°" | êµ¬ì²´ì„± ì—†ìŒ |
| ê°ì • ê³¼ì‰ | "ê¹Šì´ ê³µê°", "ë™ë ¥", "ë‚˜ì¹¨ë°˜", "í° ìš¸ë¦¼" | ê³¼ë„í•œ ê°ì • |

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ ìƒì„± í…œí”Œë¦¿: {template.name}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

**êµ¬ì¡°**:
{template.structure}

**ì˜ˆì‹œ**:
{template.example}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… ì˜¬ë°”ë¥¸ ì˜ˆì‹œ vs âŒ ì˜ëª»ëœ ì˜ˆì‹œ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… **ì˜¬ë°”ë¥¸ ì˜ˆì‹œ (ê²½ìŸì ì¸ì • 150ì, 10%)**:
"ì´ë²ˆ í—Œì • ìœ„ê¸°ì—ì„œ ì¡°ê²½íƒœ ì˜ì›ì´ ë‹¹ì„ ë„˜ì–´ ì›ì¹™ì„ ì§€í‚¨ ì ë§Œí¼ì€ ì¸ì •í•©ë‹ˆë‹¤. 
ì € ë˜í•œ ì´ëŸ¬í•œ ì›ì¹™ ìœ„ì—ì„œ ë¶€ì‚°ì˜ ë¯¸ë˜ë¥¼ ìœ„í•œ AI ì •ì±…ì„ ì¶”ì§„í•˜ê² ìŠµë‹ˆë‹¤."
â†’ ì´í›„ ìê¸°PR 900ì (50%) í•„ìˆ˜!

âŒ **ì˜ëª»ëœ ì˜ˆì‹œ (ê²½ìŸì ì¹­ì°¬ 800ì, 74% - íê¸° ëŒ€ìƒ)**:
"ì¡°ê²½íƒœ ì˜ì›ì˜ ìš©ê¸°ì— ê¹Šì´ ê³µê°í•©ë‹ˆë‹¤... ë³¸ë°›ì•„ì•¼ í•©ë‹ˆë‹¤... 
ì „ì ìœ¼ë¡œ ë™ì˜í•©ë‹ˆë‹¤... ë™ë ¥ì´ ë  ê²ƒì…ë‹ˆë‹¤..." (ì¥í™©í•œ ì¹­ì°¬ 800ì)
â†’ ìê¸°PR 300ì (25%) ë¶€ì¡± = íê¸°!

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœï¸ ì›ê³  ì •ë³´
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

**ì£¼ì œ**: {topic}
**ëª©í‘œ ê¸€ì ìˆ˜**: {valid_target_count}ì
**í™”ì**: {author_bio}

{f"**ë°°ê²½/ì§€ì‹œ**: {instructions}" if instructions else ""}
{f"**[CRITICAL] ìê¸°PR ì»¨í…ì¸  ì†ŒìŠ¤ (í•„ìˆ˜ ë°˜ì˜)**:\\n{personalized_hints}" if personalized_hints else ""}
{f"**ì°¸ê³  ë‰´ìŠ¤**: {news_context[:500]}..." if news_context else ""}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Š **[í•„ìˆ˜ ì¤€ìˆ˜] ë¹„ì¤‘ ë°°ë¶„ ê°€ì´ë“œ** (2íšŒì°¨ ê°•ì¡°)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

| ì„¹ì…˜ | ë¹„ì¤‘ | ê¸€ì ìˆ˜ ({valid_target_count}ì ê¸°ì¤€) |
| :--- | :--- | :--- |
| ìƒí™© ì„¤ëª… | 15% | ~{situation_chars}ì |
| **ê²½ìŸì ì¸ì •** | **10-20%** | **ìµœëŒ€ {comp_praise_chars}ì** |
| **ìê¸°PR/ë¹„ì „** | **50% ì´ìƒ** | **ìµœì†Œ {self_pr_chars}ì (í•„ìˆ˜!)** |
| ì°¨ë³„í™”/ë§ˆë¬´ë¦¬ | 15-25% | ~{conclusion_chars}ì |

âš ï¸ **ê²½ìŸì ì¹­ì°¬ > 20% ë˜ëŠ” ìê¸°PR < 50%ì´ë©´ ì›ê³  íê¸°!**

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”´ **[ë§ˆì§€ë§‰ í™•ì¸] ì‘ì„± ìˆœì„œ** (3íšŒì°¨ ê°•ì¡°)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. **ìê¸°PR (50%, {self_pr_chars}ì)** â† ê°€ì¥ ë¨¼ì €, ê°€ì¥ ë§ì´!
2. ìƒí™© ì„¤ëª… (15%)
3. ì°¨ë³„í™”/ë§ˆë¬´ë¦¬ (15-25%)
4. **ê²½ìŸì ì¸ì • (10-20%, ìµœëŒ€ {comp_praise_chars}ì)** â† ë§ˆì§€ë§‰ì—, ì§§ê²Œ!

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

HTML í˜•ì‹ìœ¼ë¡œ ë³¸ë¬¸ì„ ì‘ì„±í•˜ì„¸ìš”. <p> íƒœê·¸ë¡œ ë¬¸ë‹¨ì„ êµ¬ì„±í•˜ì„¸ìš”.
"""
    return prompt.strip()
